<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <input type="button" onclick="CrearExcelConAPIsinJWT();" value="Jalar datos para table">
   
    <button type="button" id="showData">Jalar datos para table con JWT</button>
    <br><br><br>

    <button type="button" id="login">Sign In</button>
  <button type="button" id="logout">Sign Out</button>

</body>


<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<script src="cvsexport.js"></script>
<script type="text/javascript">



    function CrearExcelConAPIsinJWT() {
        /*PARA TESTEAR CONEXION A WEB API (Resultados en excel)*/
        $.getJSON("https://localhost:5001/api/ctusers/", function (data) {
            console.log(data);
            myObject = data;
            var example = data;
            var x = new CSVExport(example);
            return false;
        });
    }


    //Function to send credentials through Json to API with JWT (This code is only for authentification, not for call json data)
    $(document).ready(function () {
        $("#login").click(function () {
            var options = {};
                    options.url = "http://www.miapi.com/api/login";
                    options.type = "POST";
                    var obj = {};
                    obj.usuario = "pazs";
                    obj.password = "3y5rg3otKg2CImarkIgFtA==";
                    options.data = JSON.stringify(obj);
                    options.contentType = "application/json";
                    options.dataType = "json";
                    options.success = function (obj) {
                        sessionStorage.setItem("token", obj.token);
                        $("#response").html("<h2>User successfully logged in.</h2>");
                    };
                    options.error = function () {
                        $("#response").html("<h2>Error while calling the Web API!</h2>");
                    };
                    $.ajax(options);
        });
    });


            
</script>


</html>